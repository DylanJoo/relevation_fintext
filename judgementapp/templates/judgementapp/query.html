{% extends "judgementapp/base.html" %}

{% block content %}

<div class="card">

<div class="card-body">
    <h5 class="card-title">Query Judgements</h5>
<p class="card-text">Here is the guideline.</p>
<p>
{put the labeling guideline here.}
{put the labeling guideline here.}
{put the labeling guideline here.}
</p>
</div>

<div class="card text-left m-2">
    <div class="row card-body">
        <div class="col"><h6>ID: {{query.qId}} </h6></div>
        <div class="col"><h6>Company: </h6></div>
        <div class="col"><h6>Year: </h6></div>
    </div>

    <form class="form-inline" action="" method="post"> {% csrf_token %}
    <div class="card-body row">
        <div class="col">
            <h6>{{ query.text }} </h6>
        </div>
        <div class="col-2 float-right"> 
              <div class="form-check">
                  <input class="form-check-input" type="checkbox" name="category" id="category2" value="2" 
                  {% if query.category.2 == 1%} checked {% endif %}>
                 <label class="form-check-label" for="defaultCheck1">
                     <h6>category 2</h6>
                 </label><br>
                  <input class="form-check-input" type="checkbox" name="category" id="category1" value="1"
                  {% if query.category.1 == 1%} checked {% endif %}>
                 <label class="form-check-label" for="defaultCheck1">
                     <h6>category 1</h6>
                 </label><br>
                  <input class="form-check-input" type="checkbox" name="category" id="category0" value="0"
                  {% if query.category.0 == 1%} checked {% endif %}>
                 <label class="form-check-label" for="defaultCheck1">
                     <h6>category 0</h6>
                 </label>
              </div>
        </div>
    </div>

    <div class="card-body row">
        <div class="col">
            <div><script type="text/javascript">
              function getSelectedText() {
                  if (window.getSelection) {
                      return window.getSelection().toString();
                  } else if (document.selection) {
                      return document.selection.createRange().text;
                  }
                  return '';
              }

              function captureSelection() {
                textarea = document.getElementById('comment');
                if (textarea.value.length == '') {
                  textarea.value = getSelectedText() ;
                } else if (textarea.value.length > 0) {
                  textarea.value = textarea.value + ' ||| ' + getSelectedText() ;
                }
              }
            </script></div>

            <h6><button type="button" class="btn btn-warning btn-sm" id="capture" onclick="captureSelection()">Span highlighter</button></h6>
            <div class="control-group">
                {# <div class="controls"> #}
                <textarea style="width:100%" id="comment" name="comment">{% if query.comment %}{{query.comment}}{% else %}{% endif %}</textarea>
                {# </div> #}
            </div>
        </div>
        <div class="col-2 float-right"> 
            <div class="form-actions">
                <button type="submit" class="btn btn-outline-primary btn-sm">Save</button> 
                <a href="{% url 'query' qId=query.qId %}" class="btn btn-outline-danger btn-sm">Cancel</a>
            </div>
        </div>
    </div>
    </form>

</div>

<div class="table-responsive m-2">
    <table class="table table-striped">
        <thead style="table-layout:fixed">
            <tr><th>No.</th>
                <th>Document#</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for judgement in judgements %}
            <tr><td>{{ forloop.counter }}</td>
                <td><a href="{% url 'document' qId=query.qId docId=judgement.document.docId %}">{{ judgement.document.docId }}</a></td>
                <td style="color: 
                            {% if judgement.relevance == -1 %} black {% endif %}
                            {% if judgement.relevance == 0 %} red {% endif %}
                            {% if judgement.relevance == 1 %} orange {% endif %}
                            {% if judgement.relevance == 2 %} green {% endif %} " >{{ judgement.label }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</div>
{% endblock %}

